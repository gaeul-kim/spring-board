<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">
	<select id="selectArticles" parameterType="sampleProject.board.domain.Article" resultType="sampleProject.board.domain.Article">
		<![CDATA[
		    select article_id, article_title, article_writer, article_insert_date, article_hit
		        from article 
		            where article_delete_date is null 
		                and article_category = #{category}
	    ]]>
	</select>
	<select id="selectArticle" parameterType="sampleProject.board.domain.Article"
		resultType="sampleProject.board.domain.Article">
        <![CDATA[
            select 
                article_id, article_title, article_content, article_writer, article_insert_date, article_hit, article_category
                    from article
                        where article_delete_date is null 
                            and article_id = #{article_id}
        ]]>
	</select>
	<update id="updateHit" parameterType="sampleProject.board.domain.Article">
        <![CDATA[
            update article
                set article_hit = article_hit+1
                    where article_id = #{article_id}
                        and article_delete_date is null               
        ]]>
	</update>
	<insert id="insertArticle" parameterType="sampleProject.board.domain.Article"
		useGeneratedKeys="true" keyProperty="article_id">
	   <![CDATA[
            insert into article
                (article_title, article_content, article_writer, article_password, article_category)
                    values(#{article_title}, #{article_content}, #{article_writer}, #{article_password},#{article_category})
        ]]>
	</insert>

	<update id="updateDeleteDate" parameterType="sampleProject.board.domain.Article">
        <![CDATA[
        update article 
            set article_delete_date = now()
                where article_delete_date is null
                    and article_id = #{article_id}
        ]]>
	</update>

	<update id="updateArticle" parameterType="sampleProject.board.domain.Article">
	<![CDATA[
	   update article
	       set(article_title, article_content, article_category)
	           values(#{article_title}, #{article_content}, #{article_category})
	               where article_id = #{article_id}
	]]>

	</update>
	<delete id="deleteAll">
	   <![CDATA[
	       delete from article
	   ]]>

	</delete>
</mapper>
